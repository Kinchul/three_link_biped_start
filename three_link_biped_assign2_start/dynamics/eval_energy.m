function [T, V] = eval_energy(q, dq)

    [m1, m2, m3, l1, l2, l3, g] = set_parameters();
    
    q1 = q(1);
    q2 = q(2);
    q3 = q(3);
    dq1 = dq(1);
    dq2 = dq(2);
    dq3 = dq(3);
        
    t2 = cos(q1);
    t3 = dq1.^2;
    t4 = l1.^2;
    t5 = sin(q1);
    t8 = dq1.*l1.*t2;
    t6 = -t8+dq2.*l2.*cos(q2).*(1.0./2.0);
    t10 = dq1.*l1.*t5;
    t7 = -t10+dq2.*l2.*sin(q2).*(1.0./2.0);
    t9 = t8+dq3.*l3.*cos(q3).*(1.0./2.0);
    t11 = t10+dq3.*l3.*sin(q3).*(1.0./2.0);
    T = m1.*(t2.^2.*t3.*t4.*(1.0./4.0)+t3.*t4.*t5.^2.*(1.0./4.0)).*(1.0./2.0)+m2.*(t6.^2+t7.^2).*(1.0./2.0)+m3.*(t9.^2+t11.^2).*(1.0./2.0);
    
    t2 = cos(q1);
    t3 = l1.*t2;
    V = g.*m2.*(t3-l2.*cos(q2).*(1.0./2.0))+g.*m3.*(t3+l3.*cos(q3).*(1.0./2.0))+g.*l1.*m1.*t2.*(1.0./2.0);


end